Help me understand this legacy Rails code:

[Paste complex or confusing code]

Explain:
1. What it's doing step by step
2. The design pattern it's using (if any)
3. Potential refactoring opportunities to make it more maintainable